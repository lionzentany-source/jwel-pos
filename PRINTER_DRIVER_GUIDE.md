# دليل استخدام برنامج تشغيل الطابعة المحسن\n\n## 📖 نظرة عامة\n\nتم تطوير نظام طباعة محسن في نظام جوهر يستفيد من برنامج تشغيل الطابعة الصيني `打印机测试工具V2.0.exe` لتوفير دعم شامل لجميع أنواع الطابعات.\n\n## 🖨️ الميزات الجديدة\n\n### 1. اكتشاف تلقائي للطابعات\n- **طابعات USB**: اكتشاف الطابعات المتصلة عبر USB\n- **طابعات الشبكة**: البحث في الشبكة المحلية عن طابعات TCP/IP\n- **طابعات البلوتوث**: اكتشاف الطابعات اللاسلكية\n- **طابعات Windows**: جميع الطابعات المثبتة في النظام\n\n### 2. دعم متعدد الأنواع\n```dart\n// أنواع الطابعات المدعومة\nenum PrinterType {\n  USB,      // طابعات USB المباشرة\n  Network,  // طابعات الشبكة (TCP/IP)\n  Bluetooth,// طابعات البلوتوث\n  Windows   // طابعات Windows المثبتة\n}\n```\n\n### 3. اختبار متقدم\n- اختبار الطباعة مع صفحة تجريبية\n- طباعة فاتورة تجريبية كاملة\n- تحديث حالة الطابعة في الوقت الفعلي\n\n## 🔧 كيفية الاستخدام\n\n### 1. تهيئة الخدمة\n```dart\nfinal printerService = EnhancedPrinterService();\nawait printerService.initialize();\n```\n\n### 2. اكتشاف الطابعات\n```dart\nfinal printers = await printerService.discoverPrinters();\nprint('تم العثور على ${printers.length} طابعة');\n```\n\n### 3. اختبار الطباعة\n```dart\nfinal selectedPrinter = printers.first;\nfinal success = await printerService.testPrint(selectedPrinter);\nif (success) {\n  print('الطابعة تعمل بشكل صحيح!');\n}\n```\n\n### 4. طباعة فاتورة\n```dart\nfinal invoiceData = {\n  'invoiceNumber': 'INV-001',\n  'storeName': 'متجر الجوهر',\n  'items': [...],\n  'total': 380.00,\n};\n\nfinal success = await printerService.printInvoice(selectedPrinter, invoiceData);\n```\n\n## 📱 واجهة المستخدم\n\n### شاشة الإعدادات المحسنة\n\n#### 1. قسم الاكتشاف\n- زر \"إعادة البحث\" لاكتشاف طابعات جديدة\n- عداد الطابعات المكتشفة\n- مؤشر التحميل أثناء البحث\n\n#### 2. قائمة الطابعات\n- عرض جميع الطابعات المكتشفة\n- أيقونات ملونة حسب نوع الطابعة:\n  - 🔵 أزرق: USB\n  - 🟢 أخضر: Network  \n  - 🟣 بنفسجي: Bluetooth\n  - 🟠 برتقالي: Windows\n- علامة \"افتراضية\" للطابعة الافتراضية\n- حالة الطابعة (متاح/خطأ/يعمل)\n\n#### 3. تفاصيل الطابعة المحددة\n- الاسم والنوع\n- طريقة الاتصال\n- العنوان (للطابعات الشبكة)\n- معرف الجهاز (للطابعات USB/Bluetooth)\n\n#### 4. إضافة طابعة مخصصة\n- اختيار نوع الطابعة\n- إدخال التفاصيل المطلوبة:\n  - **Network**: IP Address + Port\n  - **USB/Bluetooth**: Device ID\n  - **Windows**: اسم الطابعة\n\n#### 5. قسم الاختبار\n- \"اختبار الطباعة\": طباعة صفحة تجريبية\n- \"طباعة فاتورة تجريبية\": فاتورة كاملة للاختبار\n- \"حفظ الإعدادات\": حفظ الطابعة المحددة\n\n## 🛠️ التكامل مع برنامج التشغيل\n\n### معاملات برنامج التشغيل\n```bash\n# طابعة USB\n打印机测试工具V2.0.exe -type usb -device \"USB\\VID_04B8&PID_0202\" -file \"test.txt\"\n\n# طابعة شبكة\n打印机测试工具V2.0.exe -type network -ip \"192.168.1.100\" -port \"9100\" -file \"invoice.txt\"\n\n# طابعة بلوتوث\n打印机测试工具V2.0.exe -type bluetooth -device \"BTHENUM\\{00001101-0000-1000-8000-00805f9b34fb}\" -file \"test.txt\"\n\n# طابعة Windows\n打印机测试工具V2.0.exe -type windows -printer \"HP LaserJet\" -file \"document.txt\"\n```\n\n### تنسيق الملفات\n- **الترميز**: UTF-8 لدعم النصوص العربية\n- **التنسيق**: نص عادي مع تنسيق خاص للفواتير\n- **الملفات المؤقتة**: يتم إنشاؤها وحذفها تلقائياً\n\n## 📊 تنسيق الفواتير\n\n### مثال على فاتورة مطبوعة\n```\n================================================\n           متجر الجوهر للمجوهرات\n================================================\nالعنوان: شارع الجوهر، المدينة\nالهاتف: +218-91-1234567\n------------------------------------------------\n\nرقم الفاتورة: INV-001\nالتاريخ: 2024-01-15\nالوقت: 14:30:25\nالعميل: عميل تجريبي\n\n------------------------------------------------\nالصنف                    الكمية    السعر    الإجمالي\n------------------------------------------------\nخاتم ذهب 18 قيراط              1      250      250\nسلسلة فضة                       2       75      150\n------------------------------------------------\nالمجموع الفرعي:                           400.00 د.ل\nالخصم:                                    20.00 د.ل\n================================================\nالإجمالي:                                380.00 د.ل\n================================================\n\nطريقة الدفع: نقدي\n\n           شكراً لزيارتكم - فاتورة تجريبية\n================================================\n```\n\n## 🔍 استكشاف الأخطاء\n\n### مشاكل شائعة وحلولها\n\n#### 1. لم يتم العثور على طابعات\n**الأسباب المحتملة:**\n- الطابعة غير مشغلة\n- كابل USB غير متصل\n- برامج التشغيل غير مثبتة\n- خدمة Print Spooler متوقفة\n\n**الحلول:**\n```bash\n# إعادة تشغيل خدمة Print Spooler\nnet stop spooler\nnet start spooler\n\n# فحص الطابعات المثبتة\nwmic printer get name,status\n\n# فحص أجهزة USB\nwmic path Win32_USBDevice get DeviceID,Name\n```\n\n#### 2. فشل في الطباعة\n**التحقق من:**\n- صحة عنوان IP للطابعات الشبكة\n- توفر الورق والحبر\n- عدم وجود أخطاء في الطابعة\n- صحة معرف الجهاز للطابعات USB\n\n#### 3. مشاكل الترميز\n- التأكد من دعم الطابعة للنصوص العربية\n- استخدام ترميز UTF-8\n- فحص إعدادات الخط في الطابعة\n\n## 📈 الأداء والتحسينات\n\n### 1. اكتشاف سريع\n- البحث المتوازي في الشبكة\n- مهلة زمنية قصيرة للاتصالات\n- تخزين مؤقت للطابعات المكتشفة\n\n### 2. إدارة الذاكرة\n- حذف الملفات المؤقتة تلقائياً\n- تنظيف الموارد عند الانتهاء\n- إعادة استخدام الاتصالات\n\n### 3. معالجة الأخطاء\n- رسائل خطأ واضحة ومفيدة\n- إعادة المحاولة التلقائية\n- تسجيل مفصل للأخطاء\n\n## 🔮 التطويرات المستقبلية\n\n- [ ] دعم طابعات USB المباشرة\n- [ ] قوالب فواتير متعددة\n- [ ] طباعة الباركود والرموز\n- [ ] دعم الطباعة المجمعة\n- [ ] إعدادات طباعة متقدمة\n- [ ] تكامل مع أنظمة إدارة الطوابير\n- [ ] دعم الطباعة السحابية\n- [ ] تحليلات استخدام الطابعة\n\n## 📞 الدعم الفني\n\nللحصول على المساعدة:\n1. تحقق من سجلات التطبيق في وحدة التحكم\n2. تأكد من تحديث برامج تشغيل الطابعة\n3. جرب إعادة تشغيل خدمة Print Spooler\n4. تحقق من اتصال الشبكة للطابعات الشبكة\n\n---\n\n**ملاحظة**: هذا النظام يتطلب وجود برنامج `打印机测试工具V2.0.exe` في مجلد التطبيق الرئيسي.\n